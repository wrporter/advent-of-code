package monitor

import (
	"fmt"
	"reflect"
	"testing"
)

func TestMonitor_FindBestAsteroid(t *testing.T) {
	tests := []struct {
		lines []string
		want  Station
	}{
		{
			[]string{
				".#..#",
				".....",
				"#####",
				"....#",
				"...##",
			},
			Station{
				NumVisibleAsteroids: 8,
				Point:               Point{3, 4},
			},
		},
		{
			[]string{
				"......#.#.",
				"#..#.#....",
				"..#######.",
				".#.#.###..",
				".#..#.....",
				"..#....#.#",
				"#..#....#.",
				".##.#..###",
				"##...#..#.",
				".#....####",
			},
			Station{
				NumVisibleAsteroids: 33,
				Point:               Point{5, 8},
			},
		},
		{
			[]string{
				"#.#...#.#.",
				".###....#.",
				".#....#...",
				"##.#.#.#.#",
				"....#.#.#.",
				".##..###.#",
				"..#...##..",
				"..##....##",
				"......#...",
				".####.###.",
			},
			Station{
				NumVisibleAsteroids: 35,
				Point:               Point{1, 2},
			},
		},
		{
			[]string{
				".#..#..###",
				"####.###.#",
				"....###.#.",
				"..###.##.#",
				"##.##.#.#.",
				"....###..#",
				"..#.#..#.#",
				"#..#.#.###",
				".##...##.#",
				".....#.#..",
			},
			Station{
				NumVisibleAsteroids: 41,
				Point:               Point{6, 3},
			},
		},
		{
			[]string{
				".#..##.###...#######",
				"##.############..##.",
				".#.######.########.#",
				".###.#######.####.#.",
				"#####.##.#.##.###.##",
				"..#####..#.#########",
				"####################",
				"#.####....###.#.#.##",
				"##.#################",
				"#####.##.###..####..",
				"..######..##.#######",
				"####.##.####...##..#",
				".#####..#.######.###",
				"##...#.##########...",
				"#.##########.#######",
				".####.#.###.###.#.##",
				"....##.##.###..#####",
				".#.#.###########.###",
				"#.#.#.#####.####.###",
				"###.##.####.##.#..##",
			},
			Station{
				NumVisibleAsteroids: 210,
				Point:               Point{11, 13},
			},
		},
		{
			[]string{
				"#.....#...#.........###.#........#..",
				"....#......###..#.#.###....#......##",
				"......#..###.......#.#.#.#..#.......",
				"......#......#.#....#.##....##.#.#.#",
				"...###.#.#.......#..#...............",
				"....##...#..#....##....#...#.#......",
				"..##...#.###.....##....#.#..##.##...",
				"..##....#.#......#.#...#.#...#.#....",
				".#.##..##......##..#...#.....##...##",
				".......##.....#.....##..#..#..#.....",
				"..#..#...#......#..##...#.#...#...##",
				"......##.##.#.#.###....#.#..#......#",
				"#..#.#...#.....#...#...####.#..#...#",
				"...##...##.#..#.....####.#....##....",
				".#....###.#...#....#..#......#......",
				".##.#.#...#....##......#.....##...##",
				".....#....###...#.....#....#........",
				"...#...#....##..#.#......#.#.#......",
				".#..###............#.#..#...####.##.",
				".#.###..#.....#......#..###....##..#",
				"#......#.#.#.#.#.#...#.#.#....##....",
				".#.....#.....#...##.#......#.#...#..",
				"...##..###.........##.........#.....",
				"..#.#..#.#...#.....#.....#...###.#..",
				".#..........#.......#....#..........",
				"...##..#..#...#..#...#......####....",
				".#..#...##.##..##..###......#.......",
				".##.....#.......#..#...#..#.......#.",
				"#.#.#..#..##..#..............#....##",
				"..#....##......##.....#...#...##....",
				".##..##..#.#..#.................####",
				"##.......#..#.#..##..#...#..........",
				"#..##...#.##.#.#.........#..#..#....",
				".....#...#...#.#......#....#........",
				"....#......###.#..#......##.....#..#",
				"#..#...##.........#.....##.....#....",
			},
			Station{
				NumVisibleAsteroids: 303,
				Point:               Point{4, 8},
			},
		},
	}
	for i, tt := range tests {
		t.Run(fmt.Sprintf("Test_%d", i), func(t *testing.T) {
			m := &Monitor{}
			if got := m.FindBestAsteroid(SplitLines(tt.lines)); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("FindBestAsteroid() = %v, want %v", got, tt.want)
			}
		})
	}
}
